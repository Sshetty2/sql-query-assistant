{
  "ground_truth_sql": "SELECT TOP 5\n    master_app.[Name] AS ApplicationName,\n    COUNT(DISTINCT comp_app.[ComputerID]) AS AffectedComputerCount,\n    COUNT(DISTINCT cve.[CVEID]) AS TotalCVECount,\n    AVG(CAST(cve.[CVSSScore] AS FLOAT)) AS AvgCVSSScore\nFROM [tb_SaasMasterInstalledApps] master_app\n    INNER JOIN [tb_SaasComputerInstalledApps] comp_app\n        ON master_app.[Name] = comp_app.[Name]\n    INNER JOIN [tb_SaasComputerCVEMap] cve_map\n        ON comp_app.[ID] = cve_map.[InstalledAppID]\n    INNER JOIN [tb_CVE] cve\n        ON cve_map.[CVEID] = cve.[CVEID]\nWHERE master_app.[IsDeleted] = 0\n    AND comp_app.[IsDeleted] = 0\n    AND cve_map.[IsDeleted] = 0\n    AND cve.[IsDeleted] = 0\n    AND cve.[CVSSScore] IS NOT NULL\nGROUP BY master_app.[ID], master_app.[Name]\nHAVING COUNT(DISTINCT cve.[CVEID]) > 0\nORDER BY AvgCVSSScore DESC, TotalCVECount DESC\n",
  "generated_sql": "SELECT\n  *\nFROM [tb_SaasMasterInstalledApps]\nJOIN [tb_CVE]\n  ON [tb_SaasMasterInstalledApps].[CVEID] = [tb_CVE].[CVEID]\nJOIN [tb_CVEConfiguration]\n  ON [tb_SaasMasterInstalledApps].[CVEConfigurationID] = [tb_CVEConfiguration].[CVEConfigurationID]\nWHERE\n  (\n    (\n      (\n        (\n          [tb_SaasMasterInstalledApps].[ID] >= 0\n          AND [tb_SaasMasterInstalledApps].[Name] = NULL\n        )\n        AND [tb_CVE].[CVEID] = NULL\n      )\n      AND [tb_CVE].[CVSSScore] >= 0\n    )\n    AND [tb_CVEConfiguration].[CVEConfigurationID] = NULL\n  )\n  AND [tb_CVEConfiguration].[ConfigurationsName] = NULL\nORDER BY\n  [tb_SaasMasterInstalledApps].[ID] DESC",
  "comparison_results": {
    "tables": {
      "ground_truth": [
        "TB_CVE",
        "TB_SAASMASTERINSTALLEDAPPS",
        "TB_SAASCOMPUTERINSTALLEDAPPS",
        "TB_SAASCOMPUTERCVEMAP"
      ],
      "generated": [
        "TB_CVECONFIGURATION",
        "TB_SAASMASTERINSTALLEDAPPS",
        "TB_CVE"
      ],
      "match": false,
      "missing": [
        "TB_SAASCOMPUTERINSTALLEDAPPS",
        "TB_SAASCOMPUTERCVEMAP"
      ],
      "extra": [
        "TB_CVECONFIGURATION"
      ]
    },
    "joins": {
      "ground_truth_count": 3,
      "generated_count": 2,
      "match": false
    },
    "conditions": {
      "ground_truth_count": 1,
      "generated_count": 1,
      "match": true
    },
    "aggregations": {
      "ground_truth": [
        "COUNT(DISTINCT comp_app.\"ComputerID\")",
        "COUNT(DISTINCT cve.\"CVEID\")",
        "AVG(CAST(cve.\"CVSSScore\" AS FLOAT))",
        "COUNT(DISTINCT cve.\"CVEID\")"
      ],
      "generated": [],
      "match": false
    },
    "group_by": {
      "ground_truth": [
        "master_app.\"ID\"",
        "master_app.\"Name\""
      ],
      "generated": [],
      "match": false
    },
    "order_by": {
      "ground_truth": [
        {
          "column": "AvgCVSSScore",
          "direction": "DESC"
        },
        {
          "column": "TotalCVECount",
          "direction": "DESC"
        }
      ],
      "generated": [
        {
          "column": "\"tb_SaasMasterInstalledApps\".\"ID\"",
          "direction": "DESC"
        }
      ],
      "match": false
    }
  },
  "quality_score": 68,
  "differences_summary": "### SQL Comparison Summary\n\n**Tables X**\n- Missing: TB_SAASCOMPUTERINSTALLEDAPPS, TB_SAASCOMPUTERCVEMAP\n- Extra: TB_CVECONFIGURATION\n\n**Joins X**\n- Ground truth: 3 joins\n- Generated: 2 joins\n\n**Aggregations X**\n- Ground truth: COUNT(DISTINCT comp_app.\"ComputerID\"), COUNT(DISTINCT cve.\"CVEID\"), AVG(CAST(cve.\"CVSSScore\" AS FLOAT)), COUNT(DISTINCT cve.\"CVEID\")\n"
}